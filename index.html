<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>SH3009-2013 分液罐規格計算工具</title>
<style>
body {
    font-family: Arial, "Microsoft JhengHei", sans-serif;
    padding: 20px;
}
h1 { color: #333; }
.input-area, .output-area {
    margin-bottom: 20px;
    padding: 10px;
    border: 1px solid #ccc;
}
.input-area { background-color: #fffbcc; } /* 輸入區背景色 (淺黃) */
.output-area { background-color: #ffdede; } /* 輸出區背景色 (淺紅) */
table { border-collapse: collapse; width: 100%; }
td { padding: 5px; vertical-align: middle; }
.label { width: 200px; }
input { width: 100%; padding: 5px; box-sizing: border-box; }
.input-area input { background-color: #ffffcc; }  /* 輸入欄位背景色 (黃色) */
.output-area input[readonly] { background-color: #ffcccc; } /* 輸出欄位背景色 (粉紅) */
</style>
</head>
<body>

<h1>分液罐工藝參數計算工具 (SH3009-2013)</h1>

<div class="input-area">
  <h2>輸入區域 (黃色)</h2>
  <table>
    <tr><td class="label">操作溫度 T (°C)：</td><td><input type="number" id="T_c" value="75.74" step="any"></td></tr>
    <tr><td class="label">操作壓力 P (KPa，絕壓)：</td><td><input type="number" id="P" value="150" step="any"></td></tr>
    <tr><td class="label">氣體流量 Q (t/h)：</td><td><input type="number" id="Q" value="65" step="any"></td></tr>
    <tr><td class="label">氣體分子量 M：</td><td><input type="number" id="M" value="54.1" step="any"></td></tr>
    <tr><td class="label">液滴直徑 d<sub>1</sub> (m)：</td><td><input type="number" id="d1" value="0.0006" step="any"></td></tr>
    <tr><td class="label">液滴密度 ρ<sub>l</sub> (kg/m³)：</td><td><input type="number" id="rho_l" value="650" step="any"></td></tr>
    <tr><td class="label">阻力係數 C：</td><td><input type="number" id="C" value="0.7" step="any"></td></tr>
    <tr><td class="label">入口數 (個)：</td><td><input type="number" id="N" value="1" step="1"></td></tr>
  </table>
  <button onclick="calculate()">計算</button>
</div>

<div class="output-area">
  <h2>輸出區域 (紅色)</h2>
  <table>
    <tr><td class="label">進出口管徑 (m)：</td><td><input type="text" id="pipeDiameter" readonly></td></tr>
    <tr><td class="label">端板長度 (m)：</td><td><input type="text" id="endPlate" readonly></td></tr>
    <tr><td class="label">罐體總長 (m)：</td><td><input type="text" id="tankLength" readonly></td></tr>
    <tr><td class="label">分液罐直徑 D (m)：</td><td><input type="text" id="Dw_out" readonly></td></tr>
  </table>
</div>

<script>
// 計算功能函數
function calculate() {
    // 讀取輸入值
    var T_c = parseFloat(document.getElementById('T_c').value);
    var P = parseFloat(document.getElementById('P').value);
    var Q = parseFloat(document.getElementById('Q').value);
    var M = parseFloat(document.getElementById('M').value);
    var d1 = parseFloat(document.getElementById('d1').value);
    var rho_l = parseFloat(document.getElementById('rho_l').value);
    var C = parseFloat(document.getElementById('C').value);
    var N = parseFloat(document.getElementById('N').value);

    // 基本常數和參數（依Excel公式轉換）
    var T_K = T_c + 273.0; // 絕對溫度 (K)
    var u = 0.01022 + 0.001 * (T_c / 34.0); // 氣體動力黏度 (Cp)
    // 氣體密度 ρv (kg/m³)
    var rho_v = 1000 * M * P / (8314.0 * T_K);
    // C(Re)^2
    var Cre2 = 1.307e7 * Math.pow(d1,3) * rho_v * (rho_l - rho_v) / (u * u);
    // 液滴沉降速度 Uc (m/s)
    var Uc = 1.15 * Math.sqrt(9.81 * d1 * (rho_l - rho_v) / (rho_v * C));

    // 分液罐直徑 Dw (m) 為常數 (Excel紅色欄位)
    var Dw = 1.5;
    // 液面高度 H = Dw/3
    var H = Dw / 3.0;
    // K0 = 1 - 2*D/H (此處 D 為液面高度 H)
    var K0 = 1 - 2 * H / Dw;
    // 計算 F21 (依Excel公式)
    var F21 = (Math.acos(K0) / Math.PI) - (K0 / Math.PI) * Math.sqrt(1 - K0 * K0);
    // 常數 G23 = 2.5
    var G23 = 2.5;
    // 計算 I23, J23, K23 (依Excel公式)
    var I23 = G23 * Dw;
    var J23 = 0.6; 
    var K23 = I23 + J23 * 2;
    // 計算輸出量
    var pipeDiameter = H;                    // 進出口管徑 (Dw/3)
    var endPlate = K23;                      // 端板長度 (I23+2*J23)
    var tankLength = K23 + Dw / 2.0;         // 罐體總長 (K23 + Dw/2)

    // 顯示輸出值 (格式化結果)
    document.getElementById('pipeDiameter').value = parseFloat(pipeDiameter.toFixed(4));
    document.getElementById('endPlate').value = parseFloat(endPlate.toFixed(4));
    document.getElementById('tankLength').value = parseFloat(tankLength.toFixed(4));
    document.getElementById('Dw_out').value = parseFloat(Dw.toFixed(4));
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KO Drum è¨ˆç®—å™¨</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0fbff;
      padding: 20px;
    }
    .container {
      display: flex;
      flex-direction: column;
      max-width: 500px;
      margin: auto;
      background: #e0f7ff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
    }
    .input-group {
      margin-bottom: 15px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }
    input {
      width: 100%;
      padding: 8px;
      font-size: 1em;
    }
    .output {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .output-details {
      margin-top: 10px;
      background: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      border: 1px solid #ddd;
    }
    .output-details p {
      margin: 5px 0;
    }
    .formula-section {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .formula-section h3 {
      color: #0077aa;
      margin-top: 0;
    }
    .formula {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      font-family: monospace;
    }
    button {
      padding: 10px;
      font-size: 1em;
      background: #0077aa;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #005577;
    }
    .api521-output {
      margin-top: 20px;
      background: #ffffe0;
      padding: 18px;
      border-radius: 8px;
      border: 2px solid #b3b300;
      font-size: 1.1em;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }
    .api521-output label {
      font-weight: bold;
      margin-right: 8px;
    }
    .api521-output .api-row {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>KO Drum è‡ªå‹•è¨ˆç®—å™¨</h2>

    <div class="input-group">
      <label>æ°£é«”æµé‡ (kg/h)</label>
      <input type="number" id="W" value="687500">
    </div>

    <div class="input-group">
      <label>KO Drum ç›´å¾‘ (m)</label>
      <input type="number" id="Di" value="4">
    </div>

    <div class="input-group">
      <label>KO Drum é•·åº¦ (m)</label>
      <input type="number" id="L" value="9.5">
    </div>

    <div class="input-group">
      <label>æ¶²é«”æŒæ¶²æ·±åº¦ (m)</label>
      <input type="number" id="hl" value="2">
    </div>

    <div class="input-group">
      <label>æ¶²æ»´ç›´å¾‘ (å¾®ç±³)</label>
      <input type="number" id="d" value="600">
    </div>

    <div class="input-group">
      <label>æ¶²é«”å¯†åº¦ (kg/mÂ³)</label>
      <input type="number" id="rhoL" value="950">
    </div>

    <div class="input-group">
      <label>æ°£é«”å¯†åº¦ (kg/mÂ³)</label>
      <input type="number" id="rhoV" value="3.4">
    </div>

    <div class="input-group">
      <label>æ°£é«”é»åº¦ (cp)</label>
      <input type="number" id="mu" value="0.00745">
    </div>

    <div class="input-group">
      <label>é˜»åŠ›ä¿‚æ•¸ C</label>
      <input type="number" id="C" value="0.6">
    </div>

    <button onclick="calculate()">è¨ˆç®—</button>

    <div class="output" id="result">
      ğŸ‘‰ è«‹è¼¸å…¥è³‡æ–™ä¸¦æŒ‰ä¸‹ã€Œè¨ˆç®—ã€
    </div>
    <div class="output-details" id="detailed-result">
    </div>
    <div class="formula-section">
      <h3>ğŸ“ API è¨ˆç®—å…¬å¼èªªæ˜</h3>
      <div class="formula">
        <p><strong>1. çµ‚ç«¯é€Ÿåº¦ (Vt) è¨ˆç®—ï¼š</strong></p>
        <p>Vt = âˆš[(4 Ã— d Ã— (ÏL - ÏV) Ã— g) / (3 Ã— C Ã— ÏV)]</p>
        <p>å…¶ä¸­ï¼š</p>
        <ul>
          <li>d = æ¶²æ»´ç›´å¾‘ (m)</li>
          <li>ÏL = æ¶²é«”å¯†åº¦ (kg/mÂ³)</li>
          <li>ÏV = æ°£é«”å¯†åº¦ (kg/mÂ³)</li>
          <li>g = é‡åŠ›åŠ é€Ÿåº¦ (9.81 m/sÂ²)</li>
          <li>C = é˜»åŠ›ä¿‚æ•¸ (é€šå¸¸å– 0.6)</li>
        </ul>
      </div>

      <div class="formula">
        <p><strong>2. æˆªé¢ç© (A) è¨ˆç®—ï¼š</strong></p>
        <p>A = Ï€ Ã— (Di/2)Â²</p>
        <p>å…¶ä¸­ï¼š</p>
        <ul>
          <li>Di = KO Drum ç›´å¾‘ (m)</li>
        </ul>
      </div>

      <div class="formula">
        <p><strong>3. æ°£é«”æµé€Ÿ (Vg) è¨ˆç®—ï¼š</strong></p>
        <p>Vg = W / (3600 Ã— ÏV Ã— A)</p>
        <p>å…¶ä¸­ï¼š</p>
        <ul>
          <li>W = æ°£é«”æµé‡ (kg/h)</li>
          <li>ÏV = æ°£é«”å¯†åº¦ (kg/mÂ³)</li>
          <li>A = æˆªé¢ç© (mÂ²)</li>
        </ul>
      </div>

      <div class="formula">
        <p><strong>4. åœç•™æ™‚é–“ (t) è¨ˆç®—ï¼š</strong></p>
        <p>t = L / Vg</p>
        <p>å…¶ä¸­ï¼š</p>
        <ul>
          <li>L = KO Drum é•·åº¦ (m)</li>
          <li>Vg = æ°£é«”æµé€Ÿ (m/s)</li>
        </ul>
      </div>

      <div class="formula">
        <p><strong>5. API è¨­è¨ˆæº–å‰‡ï¼š</strong></p>
        <ul>
          <li>æ°£é«”æµé€Ÿæ‡‰å°æ–¼çµ‚ç«¯é€Ÿåº¦çš„ 75%</li>
          <li>æœ€å°åœç•™æ™‚é–“æ‡‰å¤§æ–¼ 3 ç§’</li>
          <li>æ¶²é«”æŒæ¶²æ·±åº¦æ‡‰å°æ–¼ç›´å¾‘çš„ 50%</li>
        </ul>
      </div>
    </div>
    <div class="api521-output" id="api521-output">
      <div class="api-row"><label>æ¶²æ»´æ²‰é™æ™‚é–“ Î˜ï¼š</label><span id="api-theta">-</span> ç§’</div>
      <div class="api-row"><label>æ°£é«”æµé€Ÿ Uvï¼š</label><span id="api-uv">-</span> m/s</div>
      <div class="api-row"><label>æ‰€éœ€KO Drumé•·åº¦ Lminï¼š</label><span id="api-lmin">-</span> m</div>
      <div class="api-row"><label>æ¶²é«”æŒæ¶²é«”ç© Vlï¼š</label><span id="api-vl">-</span> mÂ³</div>
      <div class="api-row"><label>é¡†ç²’æ²‰é™é€Ÿåº¦ Ucï¼š</label><span id="api-uc">-</span> m/s</div>
      <div style="margin-top:24px; text-align:center;">
        <svg id="drum-svg" width="420" height="180" viewBox="0 0 420 180">
          <!-- Drum body -->
          <ellipse cx="210" cy="90" rx="180" ry="70" fill="#e0f7ff" stroke="#0077aa" stroke-width="3" />
          <!-- Liquid level -->
          <rect x="30" y="110" width="360" height="50" fill="#b3e0ff" stroke="#0077aa" stroke-width="1" />
          <!-- Inlet -->
          <rect x="60" y="30" width="30" height="30" fill="#ccc" stroke="#888" stroke-width="2" />
          <polygon points="90,45 120,45 120,60 90,60" fill="#ccc" stroke="#888" stroke-width="2" />
          <text x="65" y="28" font-size="13" fill="#0077aa">æ°£é«”å…¥å£</text>
          <!-- Outlet -->
          <rect x="330" y="30" width="30" height="30" fill="#ccc" stroke="#888" stroke-width="2" />
          <polygon points="330,45 300,45 300,60 330,60" fill="#ccc" stroke="#888" stroke-width="2" />
          <text x="325" y="28" font-size="13" fill="#0077aa">æ°£é«”å‡ºå£</text>
          <!-- D (ç›´å¾‘) æ¨™è¨» -->
          <line x1="30" y1="90" x2="390" y2="90" stroke="#f00" stroke-width="2" marker-end="url(#arrow)" marker-start="url(#arrow)" />
          <text x="200" y="80" font-size="13" fill="#f00">D</text>
          <!-- L (é•·åº¦) æ¨™è¨» -->
          <line x1="210" y1="20" x2="210" y2="160" stroke="#0a0" stroke-width="2" marker-end="url(#arrow)" marker-start="url(#arrow)" />
          <text x="215" y="100" font-size="13" fill="#0a0">L</text>
          <!-- hl (æ¶²ä½) æ¨™è¨» -->
          <line x1="390" y1="160" x2="390" y2="110" stroke="#00a" stroke-width="2" marker-end="url(#arrow)" />
          <text x="395" y="140" font-size="13" fill="#00a">hl</text>
          <!-- Arrow marker defs -->
          <defs>
            <marker id="arrow" markerWidth="8" markerHeight="8" refX="4" refY="4" orient="auto" markerUnits="strokeWidth">
              <path d="M0,0 L8,4 L0,8 L2,4 Z" fill="#333" />
            </marker>
          </defs>
        </svg>
        <div style="font-size:13px; color:#555; margin-top:6px;">KO Drum å‰–é¢ç¤ºæ„åœ–ï¼ˆDï¼šç›´å¾‘ï¼ŒLï¼šé•·åº¦ï¼Œhlï¼šæ¶²ä½ï¼‰</div>
      </div>
    </div>
  </div>

  <div style="text-align:center; margin: 30px 0 10px 0;">
    <button onclick="window.print()" style="padding:12px 32px; font-size:1.1em; background:#0077aa; color:white; border:none; border-radius:6px; cursor:pointer;">åˆ—å°/åŒ¯å‡ºPDF</button>
  </div>

  <script>
    function calculate() {
      // ç²å–è¼¸å…¥å€¼
      const W = parseFloat(document.getElementById("W").value);
      const Di = parseFloat(document.getElementById("Di").value);
      const L = parseFloat(document.getElementById("L").value);
      const hl = parseFloat(document.getElementById("hl").value);
      const d_micron = parseFloat(document.getElementById("d").value);
      const d = d_micron / 1e6; // è½‰æ›ç‚ºå…¬å°º
      const rhoL = parseFloat(document.getElementById("rhoL").value);
      const rhoV = parseFloat(document.getElementById("rhoV").value);
      const mu = parseFloat(document.getElementById("mu").value);
      const C = parseFloat(document.getElementById("C").value);
      const g = 9.81;

      // è¨ˆç®—çµ‚ç«¯é€Ÿåº¦ (é¡†ç²’æ²‰é™é€Ÿåº¦)
      const Vt = Math.sqrt((4 * d * (rhoL - rhoV) * g) / (3 * C * rhoV));
      // è¨ˆç®—æˆªé¢ç©
      const A = Math.PI * Math.pow(Di, 2) / 4;
      // è¨ˆç®—æ°£é«”æµé€Ÿ
      const Vg = W / (3600 * rhoV * A);
      // è¨ˆç®—åœç•™æ™‚é–“
      const t = L / Vg;
      // æ¶²é«”æŒæ¶²é«”ç©
      const Vl = Math.PI * Math.pow(Di, 2) / 4 * hl;
      // æ¶²æ»´æ²‰é™æ™‚é–“ (API 521: Î˜ = hl / Vt)
      const theta = hl / Vt;
      // æ‰€éœ€KO Drumé•·åº¦ (API 521: Lmin = t * Vg)
      const Lmin = t * Vg;

      // æ›´æ–°ä¸»è¦çµæœ
      document.getElementById("result").innerHTML = `
        â˜ï¸ çµ‚ç«¯é€Ÿåº¦ Vt = <strong>${Vt.toFixed(3)}</strong> m/s
      `;
      // æ›´æ–°è©³ç´°çµæœ
      document.getElementById("detailed-result").innerHTML = `
        <p>ğŸ“Š è©³ç´°è¨ˆç®—çµæœï¼š</p>
        <p>â€¢ æ°£é«”æµé€Ÿ Vg = ${Vg.toFixed(3)} m/s</p>
        <p>â€¢ æˆªé¢ç© A = ${A.toFixed(3)} mÂ²</p>
        <p>â€¢ åœç•™æ™‚é–“ t = ${t.toFixed(3)} s</p>
        <p>â€¢ æ¶²æ»´ç›´å¾‘ = ${d_micron} Î¼m</p>
        <p>â€¢ æ¶²é«”å¯†åº¦ = ${rhoL} kg/mÂ³</p>
        <p>â€¢ æ°£é«”å¯†åº¦ = ${rhoV} kg/mÂ³</p>
      `;
      // æ›´æ–° API 521 è¼¸å‡ºå€
      document.getElementById("api-theta").innerText = isFinite(theta) ? theta.toFixed(2) : '-';
      document.getElementById("api-uv").innerText = isFinite(Vg) ? Vg.toFixed(2) : '-';
      document.getElementById("api-lmin").innerText = isFinite(Lmin) ? Lmin.toFixed(2) : '-';
      document.getElementById("api-vl").innerText = isFinite(Vl) ? Vl.toFixed(2) : '-';
      document.getElementById("api-uc").innerText = isFinite(Vt) ? Vt.toFixed(3) : '-';
    }
  </script>
</body>
</html>
